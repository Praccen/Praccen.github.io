var wt=Object.defineProperty,H=(e,t)=>{for(var r in t)wt(e,r,{get:t[r],enumerable:!0})},ne=(e,t,r)=>new Promise((i,n)=>{var s=l=>{try{o(r.next(l))}catch(c){n(c)}},a=l=>{try{o(r.throw(l))}catch(c){n(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,a);o((r=r.apply(e,t)).next())}),xe={};H(xe,{ARRAY_TYPE:()=>R,EPSILON:()=>A,RANDOM:()=>z,equals:()=>St,setMatrixArrayType:()=>Et,toRadian:()=>Tt});var A=1e-6,R=typeof Float32Array!="undefined"?Float32Array:Array,z=Math.random;function Et(e){R=e}var Pt=Math.PI/180;function Tt(e){return e*Pt}function St(e,t){return Math.abs(e-t)<=A*Math.max(1,Math.abs(e),Math.abs(t))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var At={};H(At,{add:()=>Zt,adjoint:()=>Vt,clone:()=>Lt,copy:()=>Ct,create:()=>Me,determinant:()=>Ot,equals:()=>er,exactEquals:()=>$t,frob:()=>Qt,fromMat2d:()=>Ht,fromMat4:()=>Dt,fromQuat:()=>Gt,fromRotation:()=>kt,fromScaling:()=>qt,fromTranslation:()=>jt,fromValues:()=>Ft,identity:()=>Nt,invert:()=>Ut,mul:()=>tr,multiply:()=>ye,multiplyScalar:()=>Kt,multiplyScalarAndAdd:()=>Jt,normalFromMat4:()=>Wt,projection:()=>Xt,rotate:()=>zt,scale:()=>Bt,set:()=>Rt,str:()=>Yt,sub:()=>rr,subtract:()=>be,translate:()=>_t,transpose:()=>It});function Me(){var e=new R(9);return R!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Dt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Lt(e){var t=new R(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ct(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Ft(e,t,r,i,n,s,a,o,l){var c=new R(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=i,c[4]=n,c[5]=s,c[6]=a,c[7]=o,c[8]=l,c}function Rt(e,t,r,i,n,s,a,o,l,c){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e}function Nt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function It(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Ut(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=h*a-o*c,m=-h*s+o*l,d=c*s-a*l,p=r*f+i*m+n*d;return p?(p=1/p,e[0]=f*p,e[1]=(-h*i+n*c)*p,e[2]=(o*i-n*a)*p,e[3]=m*p,e[4]=(h*r-n*l)*p,e[5]=(-o*r+n*s)*p,e[6]=d*p,e[7]=(-c*r+i*l)*p,e[8]=(a*r-i*s)*p,e):null}function Vt(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8];return e[0]=a*h-o*c,e[1]=n*c-i*h,e[2]=i*o-n*a,e[3]=o*l-s*h,e[4]=r*h-n*l,e[5]=n*s-r*o,e[6]=s*c-a*l,e[7]=i*l-r*c,e[8]=r*a-i*s,e}function Ot(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*(c*s-a*l)+r*(-c*n+a*o)+i*(l*n-s*o)}function ye(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],m=r[0],d=r[1],p=r[2],u=r[3],g=r[4],v=r[5],y=r[6],b=r[7],E=r[8];return e[0]=m*i+d*a+p*c,e[1]=m*n+d*o+p*h,e[2]=m*s+d*l+p*f,e[3]=u*i+g*a+v*c,e[4]=u*n+g*o+v*h,e[5]=u*s+g*l+v*f,e[6]=y*i+b*a+E*c,e[7]=y*n+b*o+E*h,e[8]=y*s+b*l+E*f,e}function _t(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],m=r[0],d=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=a,e[4]=o,e[5]=l,e[6]=m*i+d*a+c,e[7]=m*n+d*o+h,e[8]=m*s+d*l+f,e}function zt(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],m=Math.sin(r),d=Math.cos(r);return e[0]=d*i+m*a,e[1]=d*n+m*o,e[2]=d*s+m*l,e[3]=d*a-m*i,e[4]=d*o-m*n,e[5]=d*l-m*s,e[6]=c,e[7]=h,e[8]=f,e}function Bt(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function jt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function kt(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function qt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ht(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Gt(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,l=n+n,c=r*a,h=i*a,f=i*o,m=n*a,d=n*o,p=n*l,u=s*a,g=s*o,v=s*l;return e[0]=1-f-p,e[3]=h-v,e[6]=m+g,e[1]=h+v,e[4]=1-c-p,e[7]=d-u,e[2]=m-g,e[5]=d+u,e[8]=1-c-f,e}function Wt(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],m=t[10],d=t[11],p=t[12],u=t[13],g=t[14],v=t[15],y=r*o-i*a,b=r*l-n*a,E=r*c-s*a,T=i*l-n*o,M=i*c-s*o,P=n*c-s*l,D=h*u-f*p,C=h*g-m*p,F=h*v-d*p,I=f*g-m*u,N=f*v-d*u,U=m*v-d*g,S=y*U-b*N+E*I+T*F-M*C+P*D;return S?(S=1/S,e[0]=(o*U-l*N+c*I)*S,e[1]=(l*F-a*U-c*C)*S,e[2]=(a*N-o*F+c*D)*S,e[3]=(n*N-i*U-s*I)*S,e[4]=(r*U-n*F+s*C)*S,e[5]=(i*F-r*N-s*D)*S,e[6]=(u*P-g*M+v*T)*S,e[7]=(g*E-p*P-v*b)*S,e[8]=(p*M-u*E+v*y)*S,e):null}function Xt(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Yt(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Qt(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function Zt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function be(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function Kt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function Jt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e}function $t(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function er(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=t[0],m=t[1],d=t[2],p=t[3],u=t[4],g=t[5],v=t[6],y=t[7],b=t[8];return Math.abs(r-f)<=A*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-m)<=A*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(n-d)<=A*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(s-p)<=A*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-u)<=A*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-g)<=A*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(l-v)<=A*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-y)<=A*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(h-b)<=A*Math.max(1,Math.abs(h),Math.abs(b))}var tr=ye,rr=be,W={};H(W,{add:()=>Br,adjoint:()=>cr,clone:()=>nr,copy:()=>sr,create:()=>ir,determinant:()=>fr,equals:()=>Hr,exactEquals:()=>qr,frob:()=>zr,fromQuat:()=>Lr,fromQuat2:()=>Pr,fromRotation:()=>yr,fromRotationTranslation:()=>Pe,fromRotationTranslationScale:()=>Ar,fromRotationTranslationScaleOrigin:()=>Dr,fromScaling:()=>Mr,fromTranslation:()=>xr,fromValues:()=>ar,fromXRotation:()=>br,fromYRotation:()=>wr,fromZRotation:()=>Er,frustum:()=>Cr,getRotation:()=>Sr,getScaling:()=>Te,getTranslation:()=>Tr,identity:()=>we,invert:()=>hr,lookAt:()=>Vr,mul:()=>Gr,multiply:()=>Ee,multiplyScalar:()=>jr,multiplyScalarAndAdd:()=>kr,ortho:()=>Ir,orthoNO:()=>Ae,orthoZO:()=>Ur,perspective:()=>Fr,perspectiveFromFieldOfView:()=>Nr,perspectiveNO:()=>Se,perspectiveZO:()=>Rr,rotate:()=>gr,rotateX:()=>pr,rotateY:()=>ur,rotateZ:()=>vr,scale:()=>mr,set:()=>or,str:()=>_r,sub:()=>Wr,subtract:()=>De,targetTo:()=>Or,translate:()=>dr,transpose:()=>lr});function ir(){var e=new R(16);return R!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function nr(e){var t=new R(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function sr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ar(e,t,r,i,n,s,a,o,l,c,h,f,m,d,p,u){var g=new R(16);return g[0]=e,g[1]=t,g[2]=r,g[3]=i,g[4]=n,g[5]=s,g[6]=a,g[7]=o,g[8]=l,g[9]=c,g[10]=h,g[11]=f,g[12]=m,g[13]=d,g[14]=p,g[15]=u,g}function or(e,t,r,i,n,s,a,o,l,c,h,f,m,d,p,u,g){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=f,e[11]=m,e[12]=d,e[13]=p,e[14]=u,e[15]=g,e}function we(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function lr(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=s,e[11]=t[14],e[12]=n,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function hr(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],m=t[10],d=t[11],p=t[12],u=t[13],g=t[14],v=t[15],y=r*o-i*a,b=r*l-n*a,E=r*c-s*a,T=i*l-n*o,M=i*c-s*o,P=n*c-s*l,D=h*u-f*p,C=h*g-m*p,F=h*v-d*p,I=f*g-m*u,N=f*v-d*u,U=m*v-d*g,S=y*U-b*N+E*I+T*F-M*C+P*D;return S?(S=1/S,e[0]=(o*U-l*N+c*I)*S,e[1]=(n*N-i*U-s*I)*S,e[2]=(u*P-g*M+v*T)*S,e[3]=(m*M-f*P-d*T)*S,e[4]=(l*F-a*U-c*C)*S,e[5]=(r*U-n*F+s*C)*S,e[6]=(g*E-p*P-v*b)*S,e[7]=(h*P-m*E+d*b)*S,e[8]=(a*N-o*F+c*D)*S,e[9]=(i*F-r*N-s*D)*S,e[10]=(p*M-u*E+v*y)*S,e[11]=(f*E-h*M-d*y)*S,e[12]=(o*C-a*I-l*D)*S,e[13]=(r*I-i*C+n*D)*S,e[14]=(u*b-p*T-g*y)*S,e[15]=(h*T-f*b+m*y)*S,e):null}function cr(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],f=t[9],m=t[10],d=t[11],p=t[12],u=t[13],g=t[14],v=t[15];return e[0]=o*(m*v-d*g)-f*(l*v-c*g)+u*(l*d-c*m),e[1]=-(i*(m*v-d*g)-f*(n*v-s*g)+u*(n*d-s*m)),e[2]=i*(l*v-c*g)-o*(n*v-s*g)+u*(n*c-s*l),e[3]=-(i*(l*d-c*m)-o*(n*d-s*m)+f*(n*c-s*l)),e[4]=-(a*(m*v-d*g)-h*(l*v-c*g)+p*(l*d-c*m)),e[5]=r*(m*v-d*g)-h*(n*v-s*g)+p*(n*d-s*m),e[6]=-(r*(l*v-c*g)-a*(n*v-s*g)+p*(n*c-s*l)),e[7]=r*(l*d-c*m)-a*(n*d-s*m)+h*(n*c-s*l),e[8]=a*(f*v-d*u)-h*(o*v-c*u)+p*(o*d-c*f),e[9]=-(r*(f*v-d*u)-h*(i*v-s*u)+p*(i*d-s*f)),e[10]=r*(o*v-c*u)-a*(i*v-s*u)+p*(i*c-s*o),e[11]=-(r*(o*d-c*f)-a*(i*d-s*f)+h*(i*c-s*o)),e[12]=-(a*(f*g-m*u)-h*(o*g-l*u)+p*(o*m-l*f)),e[13]=r*(f*g-m*u)-h*(i*g-n*u)+p*(i*m-n*f),e[14]=-(r*(o*g-l*u)-a*(i*g-n*u)+p*(i*l-n*o)),e[15]=r*(o*m-l*f)-a*(i*m-n*f)+h*(i*l-n*o),e}function fr(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],f=e[10],m=e[11],d=e[12],p=e[13],u=e[14],g=e[15],v=t*a-r*s,y=t*o-i*s,b=t*l-n*s,E=r*o-i*a,T=r*l-n*a,M=i*l-n*o,P=c*p-h*d,D=c*u-f*d,C=c*g-m*d,F=h*u-f*p,I=h*g-m*p,N=f*g-m*u;return v*N-y*I+b*F+E*C-T*D+M*P}function Ee(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=t[8],m=t[9],d=t[10],p=t[11],u=t[12],g=t[13],v=t[14],y=t[15],b=r[0],E=r[1],T=r[2],M=r[3];return e[0]=b*i+E*o+T*f+M*u,e[1]=b*n+E*l+T*m+M*g,e[2]=b*s+E*c+T*d+M*v,e[3]=b*a+E*h+T*p+M*y,b=r[4],E=r[5],T=r[6],M=r[7],e[4]=b*i+E*o+T*f+M*u,e[5]=b*n+E*l+T*m+M*g,e[6]=b*s+E*c+T*d+M*v,e[7]=b*a+E*h+T*p+M*y,b=r[8],E=r[9],T=r[10],M=r[11],e[8]=b*i+E*o+T*f+M*u,e[9]=b*n+E*l+T*m+M*g,e[10]=b*s+E*c+T*d+M*v,e[11]=b*a+E*h+T*p+M*y,b=r[12],E=r[13],T=r[14],M=r[15],e[12]=b*i+E*o+T*f+M*u,e[13]=b*n+E*l+T*m+M*g,e[14]=b*s+E*c+T*d+M*v,e[15]=b*a+E*h+T*p+M*y,e}function dr(e,t,r){var i=r[0],n=r[1],s=r[2],a,o,l,c,h,f,m,d,p,u,g,v;return t===e?(e[12]=t[0]*i+t[4]*n+t[8]*s+t[12],e[13]=t[1]*i+t[5]*n+t[9]*s+t[13],e[14]=t[2]*i+t[6]*n+t[10]*s+t[14],e[15]=t[3]*i+t[7]*n+t[11]*s+t[15]):(a=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],m=t[6],d=t[7],p=t[8],u=t[9],g=t[10],v=t[11],e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=h,e[5]=f,e[6]=m,e[7]=d,e[8]=p,e[9]=u,e[10]=g,e[11]=v,e[12]=a*i+h*n+p*s+t[12],e[13]=o*i+f*n+u*s+t[13],e[14]=l*i+m*n+g*s+t[14],e[15]=c*i+d*n+v*s+t[15]),e}function mr(e,t,r){var i=r[0],n=r[1],s=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function gr(e,t,r,i){var n=i[0],s=i[1],a=i[2],o=Math.hypot(n,s,a),l,c,h,f,m,d,p,u,g,v,y,b,E,T,M,P,D,C,F,I,N,U,S,_;return o<A?null:(o=1/o,n*=o,s*=o,a*=o,l=Math.sin(r),c=Math.cos(r),h=1-c,f=t[0],m=t[1],d=t[2],p=t[3],u=t[4],g=t[5],v=t[6],y=t[7],b=t[8],E=t[9],T=t[10],M=t[11],P=n*n*h+c,D=s*n*h+a*l,C=a*n*h-s*l,F=n*s*h-a*l,I=s*s*h+c,N=a*s*h+n*l,U=n*a*h+s*l,S=s*a*h-n*l,_=a*a*h+c,e[0]=f*P+u*D+b*C,e[1]=m*P+g*D+E*C,e[2]=d*P+v*D+T*C,e[3]=p*P+y*D+M*C,e[4]=f*F+u*I+b*N,e[5]=m*F+g*I+E*N,e[6]=d*F+v*I+T*N,e[7]=p*F+y*I+M*N,e[8]=f*U+u*S+b*_,e[9]=m*U+g*S+E*_,e[10]=d*U+v*S+T*_,e[11]=p*U+y*S+M*_,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function pr(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],f=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*n+c*i,e[5]=a*n+h*i,e[6]=o*n+f*i,e[7]=l*n+m*i,e[8]=c*n-s*i,e[9]=h*n-a*i,e[10]=f*n-o*i,e[11]=m*n-l*i,e}function ur(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],c=t[8],h=t[9],f=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n-c*i,e[1]=a*n-h*i,e[2]=o*n-f*i,e[3]=l*n-m*i,e[8]=s*i+c*n,e[9]=a*i+h*n,e[10]=o*i+f*n,e[11]=l*i+m*n,e}function vr(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],a=t[1],o=t[2],l=t[3],c=t[4],h=t[5],f=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n+c*i,e[1]=a*n+h*i,e[2]=o*n+f*i,e[3]=l*n+m*i,e[4]=c*n-s*i,e[5]=h*n-a*i,e[6]=f*n-o*i,e[7]=m*n-l*i,e}function xr(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Mr(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function yr(e,t,r){var i=r[0],n=r[1],s=r[2],a=Math.hypot(i,n,s),o,l,c;return a<A?null:(a=1/a,i*=a,n*=a,s*=a,o=Math.sin(t),l=Math.cos(t),c=1-l,e[0]=i*i*c+l,e[1]=n*i*c+s*o,e[2]=s*i*c-n*o,e[3]=0,e[4]=i*n*c-s*o,e[5]=n*n*c+l,e[6]=s*n*c+i*o,e[7]=0,e[8]=i*s*c+n*o,e[9]=n*s*c-i*o,e[10]=s*s*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function br(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wr(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Er(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Pe(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=i+i,l=n+n,c=s+s,h=i*o,f=i*l,m=i*c,d=n*l,p=n*c,u=s*c,g=a*o,v=a*l,y=a*c;return e[0]=1-(d+u),e[1]=f+y,e[2]=m-v,e[3]=0,e[4]=f-y,e[5]=1-(h+u),e[6]=p+g,e[7]=0,e[8]=m+v,e[9]=p-g,e[10]=1-(h+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Pr(e,t){var r=new R(3),i=-t[0],n=-t[1],s=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],f=i*i+n*n+s*s+a*a;return f>0?(r[0]=(o*a+h*i+l*s-c*n)*2/f,r[1]=(l*a+h*n+c*i-o*s)*2/f,r[2]=(c*a+h*s+o*n-l*i)*2/f):(r[0]=(o*a+h*i+l*s-c*n)*2,r[1]=(l*a+h*n+c*i-o*s)*2,r[2]=(c*a+h*s+o*n-l*i)*2),Pe(e,t,r),e}function Tr(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Te(e,t){var r=t[0],i=t[1],n=t[2],s=t[4],a=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(r,i,n),e[1]=Math.hypot(s,a,o),e[2]=Math.hypot(l,c,h),e}function Sr(e,t){var r=new R(3);Te(r,t);var i=1/r[0],n=1/r[1],s=1/r[2],a=t[0]*i,o=t[1]*n,l=t[2]*s,c=t[4]*i,h=t[5]*n,f=t[6]*s,m=t[8]*i,d=t[9]*n,p=t[10]*s,u=a+h+p,g=0;return u>0?(g=Math.sqrt(u+1)*2,e[3]=.25*g,e[0]=(f-d)/g,e[1]=(m-l)/g,e[2]=(o-c)/g):a>h&&a>p?(g=Math.sqrt(1+a-h-p)*2,e[3]=(f-d)/g,e[0]=.25*g,e[1]=(o+c)/g,e[2]=(m+l)/g):h>p?(g=Math.sqrt(1+h-a-p)*2,e[3]=(m-l)/g,e[0]=(o+c)/g,e[1]=.25*g,e[2]=(f+d)/g):(g=Math.sqrt(1+p-a-h)*2,e[3]=(o-c)/g,e[0]=(m+l)/g,e[1]=(f+d)/g,e[2]=.25*g),e}function Ar(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3],l=n+n,c=s+s,h=a+a,f=n*l,m=n*c,d=n*h,p=s*c,u=s*h,g=a*h,v=o*l,y=o*c,b=o*h,E=i[0],T=i[1],M=i[2];return e[0]=(1-(p+g))*E,e[1]=(m+b)*E,e[2]=(d-y)*E,e[3]=0,e[4]=(m-b)*T,e[5]=(1-(f+g))*T,e[6]=(u+v)*T,e[7]=0,e[8]=(d+y)*M,e[9]=(u-v)*M,e[10]=(1-(f+p))*M,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Dr(e,t,r,i,n){var s=t[0],a=t[1],o=t[2],l=t[3],c=s+s,h=a+a,f=o+o,m=s*c,d=s*h,p=s*f,u=a*h,g=a*f,v=o*f,y=l*c,b=l*h,E=l*f,T=i[0],M=i[1],P=i[2],D=n[0],C=n[1],F=n[2],I=(1-(u+v))*T,N=(d+E)*T,U=(p-b)*T,S=(d-E)*M,_=(1-(m+v))*M,Z=(g+y)*M,K=(p+b)*P,me=(g-y)*P,ge=(1-(m+u))*P;return e[0]=I,e[1]=N,e[2]=U,e[3]=0,e[4]=S,e[5]=_,e[6]=Z,e[7]=0,e[8]=K,e[9]=me,e[10]=ge,e[11]=0,e[12]=r[0]+D-(I*D+S*C+K*F),e[13]=r[1]+C-(N*D+_*C+me*F),e[14]=r[2]+F-(U*D+Z*C+ge*F),e[15]=1,e}function Lr(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r+r,o=i+i,l=n+n,c=r*a,h=i*a,f=i*o,m=n*a,d=n*o,p=n*l,u=s*a,g=s*o,v=s*l;return e[0]=1-f-p,e[1]=h+v,e[2]=m-g,e[3]=0,e[4]=h-v,e[5]=1-c-p,e[6]=d+u,e[7]=0,e[8]=m+g,e[9]=d-u,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Cr(e,t,r,i,n,s,a){var o=1/(r-t),l=1/(n-i),c=1/(s-a);return e[0]=s*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(n+i)*l,e[10]=(a+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*s*2*c,e[15]=0,e}function Se(e,t,r,i,n){var s=1/Math.tan(t/2),a;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(a=1/(i-n),e[10]=(n+i)*a,e[14]=2*n*i*a):(e[10]=-1,e[14]=-2*i),e}var Fr=Se;function Rr(e,t,r,i,n){var s=1/Math.tan(t/2),a;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(a=1/(i-n),e[10]=n*a,e[14]=n*i*a):(e[10]=-1,e[14]=-i),e}function Nr(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(n+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-((a-o)*l*.5),e[9]=(n-s)*c*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function Ae(e,t,r,i,n,s,a){var o=1/(t-r),l=1/(i-n),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*l,e[14]=(a+s)*c,e[15]=1,e}var Ir=Ae;function Ur(e,t,r,i,n,s,a){var o=1/(t-r),l=1/(i-n),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+r)*o,e[13]=(n+i)*l,e[14]=s*c,e[15]=1,e}function Vr(e,t,r,i){var n,s,a,o,l,c,h,f,m,d,p=t[0],u=t[1],g=t[2],v=i[0],y=i[1],b=i[2],E=r[0],T=r[1],M=r[2];return Math.abs(p-E)<A&&Math.abs(u-T)<A&&Math.abs(g-M)<A?we(e):(h=p-E,f=u-T,m=g-M,d=1/Math.hypot(h,f,m),h*=d,f*=d,m*=d,n=y*m-b*f,s=b*h-v*m,a=v*f-y*h,d=Math.hypot(n,s,a),d?(d=1/d,n*=d,s*=d,a*=d):(n=0,s=0,a=0),o=f*a-m*s,l=m*n-h*a,c=h*s-f*n,d=Math.hypot(o,l,c),d?(d=1/d,o*=d,l*=d,c*=d):(o=0,l=0,c=0),e[0]=n,e[1]=o,e[2]=h,e[3]=0,e[4]=s,e[5]=l,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=m,e[11]=0,e[12]=-(n*p+s*u+a*g),e[13]=-(o*p+l*u+c*g),e[14]=-(h*p+f*u+m*g),e[15]=1,e)}function Or(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=i[0],l=i[1],c=i[2],h=n-r[0],f=s-r[1],m=a-r[2],d=h*h+f*f+m*m;d>0&&(d=1/Math.sqrt(d),h*=d,f*=d,m*=d);var p=l*m-c*f,u=c*h-o*m,g=o*f-l*h;return d=p*p+u*u+g*g,d>0&&(d=1/Math.sqrt(d),p*=d,u*=d,g*=d),e[0]=p,e[1]=u,e[2]=g,e[3]=0,e[4]=f*g-m*u,e[5]=m*p-h*g,e[6]=h*u-f*p,e[7]=0,e[8]=h,e[9]=f,e[10]=m,e[11]=0,e[12]=n,e[13]=s,e[14]=a,e[15]=1,e}function _r(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function zr(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Br(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function De(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function jr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function kr(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function qr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Hr(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],f=e[9],m=e[10],d=e[11],p=e[12],u=e[13],g=e[14],v=e[15],y=t[0],b=t[1],E=t[2],T=t[3],M=t[4],P=t[5],D=t[6],C=t[7],F=t[8],I=t[9],N=t[10],U=t[11],S=t[12],_=t[13],Z=t[14],K=t[15];return Math.abs(r-y)<=A*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-b)<=A*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(n-E)<=A*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(s-T)<=A*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-M)<=A*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(o-P)<=A*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(l-D)<=A*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(c-C)<=A*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-F)<=A*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(f-I)<=A*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(m-N)<=A*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(d-U)<=A*Math.max(1,Math.abs(d),Math.abs(U))&&Math.abs(p-S)<=A*Math.max(1,Math.abs(p),Math.abs(S))&&Math.abs(u-_)<=A*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(g-Z)<=A*Math.max(1,Math.abs(g),Math.abs(Z))&&Math.abs(v-K)<=A*Math.max(1,Math.abs(v),Math.abs(K))}var Gr=Ee,Wr=De,Xr={};H(Xr,{add:()=>pn,calculateW:()=>nn,clone:()=>fn,conjugate:()=>ln,copy:()=>mn,create:()=>ae,dot:()=>ot,equals:()=>bn,exactEquals:()=>yn,exp:()=>it,fromEuler:()=>hn,fromMat3:()=>st,fromValues:()=>dn,getAngle:()=>$i,getAxisAngle:()=>Ji,identity:()=>Ki,invert:()=>on,len:()=>xn,length:()=>lt,lerp:()=>vn,ln:()=>nt,mul:()=>un,multiply:()=>rt,normalize:()=>fe,pow:()=>sn,random:()=>an,rotateX:()=>en,rotateY:()=>tn,rotateZ:()=>rn,rotationTo:()=>wn,scale:()=>at,set:()=>gn,setAxes:()=>Pn,setAxisAngle:()=>tt,slerp:()=>te,sqlerp:()=>En,sqrLen:()=>Mn,squaredLength:()=>ht,str:()=>cn});var x={};H(x,{add:()=>Kr,angle:()=>vi,bezier:()=>hi,ceil:()=>Jr,clone:()=>Yr,copy:()=>Qr,create:()=>oe,cross:()=>ee,dist:()=>Ti,distance:()=>Ne,div:()=>Pi,divide:()=>Re,dot:()=>le,equals:()=>bi,exactEquals:()=>yi,floor:()=>$r,forEach:()=>Di,fromValues:()=>se,hermite:()=>li,inverse:()=>ai,len:()=>Oe,length:()=>Le,lerp:()=>oi,max:()=>ti,min:()=>ei,mul:()=>Ei,multiply:()=>Fe,negate:()=>si,normalize:()=>Ve,random:()=>ci,rotateX:()=>gi,rotateY:()=>pi,rotateZ:()=>ui,round:()=>ri,scale:()=>ii,scaleAndAdd:()=>ni,set:()=>Zr,sqrDist:()=>Si,sqrLen:()=>Ai,squaredDistance:()=>Ie,squaredLength:()=>Ue,str:()=>Mi,sub:()=>wi,subtract:()=>Ce,transformMat3:()=>di,transformMat4:()=>fi,transformQuat:()=>mi,zero:()=>xi});function oe(){var e=new R(3);return R!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Yr(e){var t=new R(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Le(e){var t=e[0],r=e[1],i=e[2];return Math.hypot(t,r,i)}function se(e,t,r){var i=new R(3);return i[0]=e,i[1]=t,i[2]=r,i}function Qr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Zr(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function Kr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Ce(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Fe(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Re(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Jr(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function $r(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function ei(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function ti(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function ri(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function ii(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function ni(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e}function Ne(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.hypot(r,i,n)}function Ie(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n}function Ue(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function si(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function ai(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function Ve(e,t){var r=t[0],i=t[1],n=t[2],s=r*r+i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function le(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ee(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],l=r[2];return e[0]=n*l-s*o,e[1]=s*a-i*l,e[2]=i*o-n*a,e}function oi(e,t,r,i){var n=t[0],s=t[1],a=t[2];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=a+i*(r[2]-a),e}function li(e,t,r,i,n,s){var a=s*s,o=a*(2*s-3)+1,l=a*(s-2)+s,c=a*(s-1),h=a*(3-2*s);return e[0]=t[0]*o+r[0]*l+i[0]*c+n[0]*h,e[1]=t[1]*o+r[1]*l+i[1]*c+n[1]*h,e[2]=t[2]*o+r[2]*l+i[2]*c+n[2]*h,e}function hi(e,t,r,i,n,s){var a=1-s,o=a*a,l=s*s,c=o*a,h=3*s*o,f=3*l*a,m=l*s;return e[0]=t[0]*c+r[0]*h+i[0]*f+n[0]*m,e[1]=t[1]*c+r[1]*h+i[1]*f+n[1]*m,e[2]=t[2]*c+r[2]*h+i[2]*f+n[2]*m,e}function ci(e,t){t=t||1;var r=z()*2*Math.PI,i=z()*2-1,n=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*n,e[1]=Math.sin(r)*n,e[2]=i*t,e}function fi(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[3]*i+r[7]*n+r[11]*s+r[15];return a=a||1,e[0]=(r[0]*i+r[4]*n+r[8]*s+r[12])/a,e[1]=(r[1]*i+r[5]*n+r[9]*s+r[13])/a,e[2]=(r[2]*i+r[6]*n+r[10]*s+r[14])/a,e}function di(e,t,r){var i=t[0],n=t[1],s=t[2];return e[0]=i*r[0]+n*r[3]+s*r[6],e[1]=i*r[1]+n*r[4]+s*r[7],e[2]=i*r[2]+n*r[5]+s*r[8],e}function mi(e,t,r){var i=r[0],n=r[1],s=r[2],a=r[3],o=t[0],l=t[1],c=t[2],h=n*c-s*l,f=s*o-i*c,m=i*l-n*o,d=n*m-s*f,p=s*h-i*m,u=i*f-n*h,g=a*2;return h*=g,f*=g,m*=g,d*=2,p*=2,u*=2,e[0]=o+h+d,e[1]=l+f+p,e[2]=c+m+u,e}function gi(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0],s[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),s[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function pi(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),s[1]=n[1],s[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function ui(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),s[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),s[2]=n[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function vi(e,t){var r=e[0],i=e[1],n=e[2],s=t[0],a=t[1],o=t[2],l=Math.sqrt(r*r+i*i+n*n),c=Math.sqrt(s*s+a*a+o*o),h=l*c,f=h&&le(e,t)/h;return Math.acos(Math.min(Math.max(f,-1),1))}function xi(e){return e[0]=0,e[1]=0,e[2]=0,e}function Mi(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function yi(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function bi(e,t){var r=e[0],i=e[1],n=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(r-s)<=A*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-a)<=A*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-o)<=A*Math.max(1,Math.abs(n),Math.abs(o))}var wi=Ce,Ei=Fe,Pi=Re,Ti=Ne,Si=Ie,Oe=Le,Ai=Ue,Di=function(){var e=oe();return function(t,r,i,n,s,a){var o,l;for(r||(r=3),i||(i=0),n?l=Math.min(n*r+i,t.length):l=t.length,o=i;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}}(),j={};H(j,{add:()=>qe,ceil:()=>Li,clone:()=>ze,copy:()=>je,create:()=>_e,cross:()=>Oi,dist:()=>Wi,distance:()=>Ye,div:()=>Gi,divide:()=>We,dot:()=>Ke,equals:()=>et,exactEquals:()=>$e,floor:()=>Ci,forEach:()=>Zi,fromValues:()=>Be,inverse:()=>Vi,len:()=>Yi,length:()=>he,lerp:()=>Je,max:()=>Ri,min:()=>Fi,mul:()=>Hi,multiply:()=>Ge,negate:()=>Ui,normalize:()=>Ze,random:()=>_i,round:()=>Ni,scale:()=>Xe,scaleAndAdd:()=>Ii,set:()=>ke,sqrDist:()=>Xi,sqrLen:()=>Qi,squaredDistance:()=>Qe,squaredLength:()=>ce,str:()=>ki,sub:()=>qi,subtract:()=>He,transformMat4:()=>zi,transformQuat:()=>Bi,zero:()=>ji});function _e(){var e=new R(4);return R!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ze(e){var t=new R(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Be(e,t,r,i){var n=new R(4);return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function je(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function ke(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function qe(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function He(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Ge(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function We(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Li(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Ci(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Fi(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Ri(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Ni(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Xe(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Ii(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function Ye(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,i,n,s)}function Qe(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return r*r+i*i+n*n+s*s}function he(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.hypot(t,r,i,n)}function ce(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function Ui(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Vi(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Ze(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=i*a,e[2]=n*a,e[3]=s*a,e}function Ke(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Oi(e,t,r,i){var n=r[0]*i[1]-r[1]*i[0],s=r[0]*i[2]-r[2]*i[0],a=r[0]*i[3]-r[3]*i[0],o=r[1]*i[2]-r[2]*i[1],l=r[1]*i[3]-r[3]*i[1],c=r[2]*i[3]-r[3]*i[2],h=t[0],f=t[1],m=t[2],d=t[3];return e[0]=f*c-m*l+d*o,e[1]=-(h*c)+m*a-d*s,e[2]=h*l-f*a+d*n,e[3]=-(h*o)+f*s-m*n,e}function Je(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=a+i*(r[2]-a),e[3]=o+i*(r[3]-o),e}function _i(e,t){t=t||1;var r,i,n,s,a,o;do r=z()*2-1,i=z()*2-1,a=r*r+i*i;while(a>=1);do n=z()*2-1,s=z()*2-1,o=n*n+s*s;while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*r,e[1]=t*i,e[2]=t*n*l,e[3]=t*s*l,e}function zi(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*s+r[12]*a,e[1]=r[1]*i+r[5]*n+r[9]*s+r[13]*a,e[2]=r[2]*i+r[6]*n+r[10]*s+r[14]*a,e[3]=r[3]*i+r[7]*n+r[11]*s+r[15]*a,e}function Bi(e,t,r){var i=t[0],n=t[1],s=t[2],a=r[0],o=r[1],l=r[2],c=r[3],h=c*i+o*s-l*n,f=c*n+l*i-a*s,m=c*s+a*n-o*i,d=-a*i-o*n-l*s;return e[0]=h*c+d*-a+f*-l-m*-o,e[1]=f*c+d*-o+m*-a-h*-l,e[2]=m*c+d*-l+h*-o-f*-a,e[3]=t[3],e}function ji(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function ki(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function $e(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function et(e,t){var r=e[0],i=e[1],n=e[2],s=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(r-a)<=A*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=A*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-l)<=A*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-c)<=A*Math.max(1,Math.abs(s),Math.abs(c))}var qi=He,Hi=Ge,Gi=We,Wi=Ye,Xi=Qe,Yi=he,Qi=ce,Zi=function(){var e=_e();return function(t,r,i,n,s,a){var o,l;for(r||(r=4),i||(i=0),n?l=Math.min(n*r+i,t.length):l=t.length,o=i;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}();function ae(){var e=new R(4);return R!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ki(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function tt(e,t,r){r=r*.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function Ji(e,t){var r=Math.acos(t[3])*2,i=Math.sin(r/2);return i>A?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),r}function $i(e,t){var r=ot(e,t);return Math.acos(2*r*r-1)}function rt(e,t,r){var i=t[0],n=t[1],s=t[2],a=t[3],o=r[0],l=r[1],c=r[2],h=r[3];return e[0]=i*h+a*o+n*c-s*l,e[1]=n*h+a*l+s*o-i*c,e[2]=s*h+a*c+i*l-n*o,e[3]=a*h-i*o-n*l-s*c,e}function en(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+a*o,e[1]=n*l+s*o,e[2]=s*l-n*o,e[3]=a*l-i*o,e}function tn(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l-s*o,e[1]=n*l+a*o,e[2]=s*l+i*o,e[3]=a*l-n*o,e}function rn(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],a=t[3],o=Math.sin(r),l=Math.cos(r);return e[0]=i*l+n*o,e[1]=n*l-i*o,e[2]=s*l+a*o,e[3]=a*l-s*o,e}function nn(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e}function it(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=Math.sqrt(r*r+i*i+n*n),o=Math.exp(s),l=a>0?o*Math.sin(a)/a:0;return e[0]=r*l,e[1]=i*l,e[2]=n*l,e[3]=o*Math.cos(a),e}function nt(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=Math.sqrt(r*r+i*i+n*n),o=a>0?Math.atan2(a,s)/a:0;return e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=.5*Math.log(r*r+i*i+n*n+s*s),e}function sn(e,t,r){return nt(e,t),at(e,e,r),it(e,e),e}function te(e,t,r,i){var n=t[0],s=t[1],a=t[2],o=t[3],l=r[0],c=r[1],h=r[2],f=r[3],m,d,p,u,g;return d=n*l+s*c+a*h+o*f,d<0&&(d=-d,l=-l,c=-c,h=-h,f=-f),1-d>A?(m=Math.acos(d),p=Math.sin(m),u=Math.sin((1-i)*m)/p,g=Math.sin(i*m)/p):(u=1-i,g=i),e[0]=u*n+g*l,e[1]=u*s+g*c,e[2]=u*a+g*h,e[3]=u*o+g*f,e}function an(e){var t=z(),r=z(),i=z(),n=Math.sqrt(1-t),s=Math.sqrt(t);return e[0]=n*Math.sin(2*Math.PI*r),e[1]=n*Math.cos(2*Math.PI*r),e[2]=s*Math.sin(2*Math.PI*i),e[3]=s*Math.cos(2*Math.PI*i),e}function on(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=r*r+i*i+n*n+s*s,o=a?1/a:0;return e[0]=-r*o,e[1]=-i*o,e[2]=-n*o,e[3]=s*o,e}function ln(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function st(e,t){var r=t[0]+t[4]+t[8],i;if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[n*3+n]&&(n=2);var s=(n+1)%3,a=(n+2)%3;i=Math.sqrt(t[n*3+n]-t[s*3+s]-t[a*3+a]+1),e[n]=.5*i,i=.5/i,e[3]=(t[s*3+a]-t[a*3+s])*i,e[s]=(t[s*3+n]+t[n*3+s])*i,e[a]=(t[a*3+n]+t[n*3+a])*i}return e}function hn(e,t,r,i){var n=.5*Math.PI/180;t*=n,r*=n,i*=n;var s=Math.sin(t),a=Math.cos(t),o=Math.sin(r),l=Math.cos(r),c=Math.sin(i),h=Math.cos(i);return e[0]=s*l*h-a*o*c,e[1]=a*o*h+s*l*c,e[2]=a*l*c-s*o*h,e[3]=a*l*h+s*o*c,e}function cn(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var fn=ze,dn=Be,mn=je,gn=ke,pn=qe,un=rt,at=Xe,ot=Ke,vn=Je,lt=he,xn=lt,ht=ce,Mn=ht,fe=Ze,yn=$e,bn=et,wn=function(){var e=oe(),t=se(1,0,0),r=se(0,1,0);return function(i,n,s){var a=le(n,s);return a<-.999999?(ee(e,t,n),Oe(e)<1e-6&&ee(e,r,n),Ve(e,e),tt(i,e,Math.PI),i):a>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(ee(e,n,s),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+a,fe(i,i))}}(),En=function(){var e=ae(),t=ae();return function(r,i,n,s,a,o){return te(e,i,a,o),te(t,n,s,o),te(r,e,t,2*o*(1-o)),r}}(),Pn=function(){var e=Me();return function(t,r,i,n){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],fe(t,st(t,e))}}(),B={};H(B,{add:()=>Ln,angle:()=>Qn,ceil:()=>Cn,clone:()=>Tn,copy:()=>An,create:()=>ct,cross:()=>jn,dist:()=>ns,distance:()=>gt,div:()=>is,divide:()=>mt,dot:()=>Bn,equals:()=>$n,exactEquals:()=>Jn,floor:()=>Fn,forEach:()=>os,fromValues:()=>Sn,inverse:()=>_n,len:()=>es,length:()=>ut,lerp:()=>kn,max:()=>Nn,min:()=>Rn,mul:()=>rs,multiply:()=>dt,negate:()=>On,normalize:()=>zn,random:()=>qn,rotate:()=>Yn,round:()=>In,scale:()=>Un,scaleAndAdd:()=>Vn,set:()=>Dn,sqrDist:()=>ss,sqrLen:()=>as,squaredDistance:()=>pt,squaredLength:()=>vt,str:()=>Kn,sub:()=>ts,subtract:()=>ft,transformMat2:()=>Hn,transformMat2d:()=>Gn,transformMat3:()=>Wn,transformMat4:()=>Xn,zero:()=>Zn});function ct(){var e=new R(2);return R!=Float32Array&&(e[0]=0,e[1]=0),e}function Tn(e){var t=new R(2);return t[0]=e[0],t[1]=e[1],t}function Sn(e,t){var r=new R(2);return r[0]=e,r[1]=t,r}function An(e,t){return e[0]=t[0],e[1]=t[1],e}function Dn(e,t,r){return e[0]=t,e[1]=r,e}function Ln(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function ft(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function dt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function mt(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function Cn(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Fn(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Rn(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Nn(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function In(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function Un(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Vn(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function gt(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.hypot(r,i)}function pt(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function ut(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function vt(e){var t=e[0],r=e[1];return t*t+r*r}function On(e,t){return e[0]=-t[0],e[1]=-t[1],e}function _n(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function zn(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e}function Bn(e,t){return e[0]*t[0]+e[1]*t[1]}function jn(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function kn(e,t,r,i){var n=t[0],s=t[1];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e}function qn(e,t){t=t||1;var r=z()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Hn(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e}function Gn(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e}function Wn(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e}function Xn(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e}function Yn(e,t,r,i){var n=t[0]-r[0],s=t[1]-r[1],a=Math.sin(i),o=Math.cos(i);return e[0]=n*o-s*a+r[0],e[1]=n*a+s*o+r[1],e}function Qn(e,t){var r=e[0],i=e[1],n=t[0],s=t[1],a=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+s*s),o=a&&(r*n+i*s)/a;return Math.acos(Math.min(Math.max(o,-1),1))}function Zn(e){return e[0]=0,e[1]=0,e}function Kn(e){return"vec2("+e[0]+", "+e[1]+")"}function Jn(e,t){return e[0]===t[0]&&e[1]===t[1]}function $n(e,t){var r=e[0],i=e[1],n=t[0],s=t[1];return Math.abs(r-n)<=A*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-s)<=A*Math.max(1,Math.abs(i),Math.abs(s))}var es=ut,ts=ft,rs=dt,is=mt,ns=gt,ss=pt,as=vt,os=function(){var e=ct();return function(t,r,i,n,s,a){var o,l;for(r||(r=2),i||(i=0),n?l=Math.min(n*r+i,t.length):l=t.length,o=i;o<l;o+=r)e[0]=t[o],e[1]=t[o+1],s(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}();var J=class{constructor(e=!0,t=w.RGBA,r=w.RGBA,i=w.UNSIGNED_BYTE,n=w.TEXTURE_2D){this.useMipMap=e,this.internalFormat=t,this.format=r,this.dataStorageType=i,this.textureTarget=n,this.texture=w.createTexture(),w.bindTexture(this.textureTarget,this.texture),w.texParameteri(this.textureTarget,w.TEXTURE_WRAP_S,w.REPEAT),w.texParameteri(this.textureTarget,w.TEXTURE_WRAP_T,w.REPEAT),w.texParameteri(this.textureTarget,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(this.textureTarget,w.TEXTURE_MAG_FILTER,w.NEAREST),w.pixelStorei(w.UNPACK_FLIP_Y_WEBGL,!0),this.setTextureData(null,1,1),w.bindTexture(this.textureTarget,null)}setTextureData(e,t,r){this.width=t,this.height=r,w.bindTexture(this.textureTarget,this.texture),w.texImage2D(this.textureTarget,0,this.internalFormat,t,r,0,this.format,this.dataStorageType,e),this.useMipMap&&(w.generateMipmap(this.textureTarget),w.texParameteri(this.textureTarget,w.TEXTURE_MIN_FILTER,w.LINEAR_MIPMAP_LINEAR)),w.bindTexture(this.textureTarget,null),this.loadedFromFile=!1}bind(e=0){w.activeTexture(w.TEXTURE0+e),w.bindTexture(this.textureTarget,this.texture)}loadFromFile(e){let t=new Image;t.crossOrigin="",t.src=e;let r=this;t.addEventListener("load",function(){r.width=t.width,r.height=t.height,w.bindTexture(r.textureTarget,r.texture),w.texImage2D(r.textureTarget,0,r.internalFormat,r.format,r.dataStorageType,t),r.useMipMap&&(w.generateMipmap(r.textureTarget),w.texParameteri(r.textureTarget,w.TEXTURE_MIN_FILTER,w.LINEAR_MIPMAP_LINEAR)),r.loadedFromFile=!0})}createFromCSSColorValue(e){let t=0,r=0,i=0,n=255;if(e.startsWith("#"))e.length>=7&&(t=parseInt(e.slice(1,3),16),r=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16),e.length==9&&(n=parseInt(e.slice(7,9),16)));else if(e.startsWith("rgba(")){let s=e.lastIndexOf(")"),a=e.substring(5,s).split(",").map(o=>parseFloat(o));t=a[0],r=a[1],i=a[2],n=a[3]*255}else if(e.startsWith("rgb(")){let s=e.lastIndexOf(")"),a=e.substring(4,s).split(",").map(o=>parseInt(o));t=a[0],r=a[1],i=a[2]}this.setTextureData(new Uint8Array([t,r,i,n]),1,1)}setTexParameterI(e,t){w.bindTexture(this.textureTarget,this.texture),w.texParameteri(this.textureTarget,e,t),w.bindTexture(this.textureTarget,null)}},ls=class{constructor(e){this.shaderProgram=e,this.VAO=null,this.VBO=null,this.EBO=null,this.init()}init(){this.VAO=w.createVertexArray(),this.VBO=w.createBuffer(),this.EBO=w.createBuffer(),w.bindVertexArray(this.VAO),w.bindBuffer(w.ARRAY_BUFFER,this.VBO),this.shaderProgram.setupVertexAttributePointers(),w.bindVertexArray(null)}bindVAO(){w.bindVertexArray(this.VAO)}unbindVAO(){w.bindVertexArray(null)}setVertexData(e){e==null||e.length==0||(w.bindVertexArray(this.VAO),w.bindBuffer(w.ARRAY_BUFFER,this.VBO),w.bufferData(w.ARRAY_BUFFER,e,w.STATIC_DRAW),w.bindVertexArray(null))}setIndexData(e){w.bindVertexArray(this.VAO),w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,this.EBO),w.bufferData(w.ELEMENT_ARRAY_BUFFER,e,w.STATIC_DRAW),w.bindVertexArray(null)}getVertexPositions(){return null}draw(){}};var hs=null;var w,Ls=Date.now();var cs=class extends J{constructor(e=!0,t=w.RGBA,r=w.RGBA,i=w.UNSIGNED_BYTE,n=w.TEXTURE_CUBE_MAP){super(e,t,r,i,n),this.setTexParameterI(w.TEXTURE_WRAP_R,w.REPEAT),this.sidesLoaded=0}setTextureData(e,t,r,i){if(this.width=t,this.height=r,w.bindTexture(this.textureTarget,this.texture),i==null)for(let n=0;n<6;n++)w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,this.internalFormat,this.width,this.height,0,this.format,this.dataStorageType,e);else w.texImage2D(i,0,this.internalFormat,this.width,this.height,0,this.format,this.dataStorageType,e);w.bindTexture(this.textureTarget,null)}loadCubemap(e){for(let t=0;t<e.length;t++){let r=new Image;r.crossOrigin="",r.src=e[t];let i=this;r.addEventListener("load",function(){i.width=r.width,i.height=r.height,w.bindTexture(i.textureTarget,i.texture),w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,i.internalFormat,i.format,i.dataStorageType,r),i.sidesLoaded++,i.sidesLoaded>=6&&(i.loadedFromFile=!0,i.useMipMap&&(w.generateMipmap(i.textureTarget),w.texParameteri(i.textureTarget,w.TEXTURE_MIN_FILTER,w.LINEAR_MIPMAP_LINEAR)))})}}};var fs=class{constructor(){this.textures=new Map,this.cubeMaps=new Map}setTexture(e,t){this.textures.set(e,t)}getTexture(e){let t=this.textures.get(e);if(t)return t;let r=new J,i="CSS:";return e.startsWith(i)?r.createFromCSSColorValue(e.substring(i.length)):r.loadFromFile(e),this.textures.set(e,r),r}getCubeMap(e){let t=this.cubeMaps.get(e);if(t)return t;let r=new cs;return r.loadCubemap([e+"/right.png",e+"/left.png",e+"/bottom.png",e+"/top.png",e+"/front.png",e+"/back.png"]),this.cubeMaps.set(e,r),r}},ds=class extends ls{constructor(e,t){super(e),this.vertices=t,this.setVertexData(this.vertices)}setVertexData(e){super.setVertexData(e),this.vertices=e}getVertexPositions(){if(this.vertices==null)return null;let e=new Array;for(let t=0;t<this.vertices.length;t+=8)e.push(x.fromValues(this.vertices[t],this.vertices[t+1],this.vertices[t+2]));return e}draw(){this.vertices!=null&&this.vertices.length>0&&(this.bindVAO(),w.drawArrays(w.TRIANGLES,0,this.vertices.length/8))}},ms=class{constructor(e){this.meshMap=new Map,this.heightmapMap=new Map,this.textureStore=e}loadMeshes(e,t){return ne(this,null,function*(){return new Promise((r,i)=>{t.loaded=0;for(let n of e)this.getMesh(hs,n).then(()=>{t.loaded++,t.loaded==e.length&&r()})})})}getMesh(e,t){return ne(this,null,function*(){let r=this.meshMap.get(t);if(r)return new Promise((n,s)=>{n(r)});this.meshMap.set(t,new ds(e,null));let i=this.meshMap.get(t);return this.parseObjContent(t).then(n=>(i.setVertexData(n),i))})}parseObjContent(e){return ne(this,null,function*(){let i=(yield(yield fetch(e)).text()).split(`
`),n=new Array,s=new Array,a=new Array,o=new Array,l=new Map,c="";for(let f of i)if(f=f.trim(),f.startsWith("mtllib")){let m=f.split(/\s+/).filter(d=>d!="mtllib");if(m.length==1){let d=e.substring(0,e.lastIndexOf("/")+1)+m;try{let p=yield fetch(d);if(p.ok){let u=yield p.text(),g="",v=0;for(let M of u.split(`
`))if(M.startsWith("newmtl")){let P=M.split(/\s+/);P.length>1&&(g=P[1],l.set(g,{diffuseColor:x.create(),specularColor:x.create(),emissionColor:x.create(),dissolve:1,spriteIndex:v}),v++)}else if(M.startsWith("Kd")&&g!=""){let P=M.split(/\s+/).filter(D=>D!="Kd");P.length>2&&x.set(l.get(g).diffuseColor,parseFloat(P[0]),parseFloat(P[1]),parseFloat(P[2]))}else if(M.startsWith("Ks")&&g!=""){let P=M.split(/\s+/).filter(D=>D!="Ks");P.length>2&&x.set(l.get(g).specularColor,parseFloat(P[0]),parseFloat(P[1]),parseFloat(P[2]))}else if(M.startsWith("Ke")&&g!=""){let P=M.split(/\s+/).filter(D=>D!="Ke");P.length>2&&x.set(l.get(g).emissionColor,parseFloat(P[0]),parseFloat(P[1]),parseFloat(P[2]))}else if(M.startsWith("d")&&g!=""){let P=M.split(/\s+/).filter(D=>D!="d");P.length>0&&(l.get(g).dissolve=parseFloat(P[0]))}let y=new Uint8Array(v*4);for(let M of l)y[M[1].spriteIndex*4+0]=M[1].diffuseColor[0]*255,y[M[1].spriteIndex*4+1]=M[1].diffuseColor[1]*255,y[M[1].spriteIndex*4+2]=M[1].diffuseColor[2]*255,y[M[1].spriteIndex*4+3]=M[1].dissolve*255;let b=new J(!1);b.setTextureData(y,v,1),this.textureStore.setTexture(d,b);let E=new Uint8Array(v*4);for(let M of l)E[M[1].spriteIndex*4+0]=M[1].specularColor[0]*255,E[M[1].spriteIndex*4+1]=M[1].specularColor[1]*255,E[M[1].spriteIndex*4+2]=M[1].specularColor[2]*255,E[M[1].spriteIndex*4+3]=255;b=new J(!1),b.setTextureData(E,v,1),this.textureStore.setTexture(d.substring(0,d.length-4)+"_spec.mtl",b);let T=new Uint8Array(v*4);for(let M of l)T[M[1].spriteIndex*4+0]=M[1].emissionColor[0]*255,T[M[1].spriteIndex*4+1]=M[1].emissionColor[1]*255,T[M[1].spriteIndex*4+2]=M[1].emissionColor[2]*255,T[M[1].spriteIndex*4+3]=255;b=new J(!1),b.setTextureData(T,v,1),this.textureStore.setTexture(d.substring(0,d.length-4)+"_emission.mtl",b)}}catch(p){}}}else if(f.startsWith("usemtl")&&l.size>0)c=f.split(/\s+/)[1];else if(f.startsWith("vt")){let m=f.split(/\s+/).filter(d=>d!="vt");s.push(B.fromValues(parseFloat(m[0]),parseFloat(m[1])))}else if(f.startsWith("vn")){let m=f.split(/\s+/).filter(d=>d!="vn");a.push(x.fromValues(parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])))}else if(f.startsWith("v")){let m=f.split(/\s+/).filter(d=>d!="v");n.push(x.fromValues(parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])))}else if(f.startsWith("f")){let m=f.split(/\s+/).filter(d=>d!="f");for(let d=0;d<m.length-2;d++)for(let p=0;p<3;p++){let u=p==0?0:d+p,g=m[u].split("/"),v=o.push({posIndex:NaN,texCoordIndex:NaN,normalIndex:NaN,mtlIndex:NaN});if(g.length>0&&(o[v-1].posIndex=parseInt(g[0])-1),g.length>1&&(o[v-1].texCoordIndex=parseInt(g[1])-1),g.length>2&&(o[v-1].normalIndex=parseInt(g[2])-1),c!=""){let y=l.get(c);y!=null?o[v-1].mtlIndex=y.spriteIndex:console.warn("usemtl "+c+", there is no such mtl")}}}else f.startsWith("#")||f.length>0;let h=new Float32Array(o.length*8);for(let f=0;f<o.length;f++)isNaN(o[f].posIndex)?(h[f*8]=0,h[f*8+1]=0,h[f*8+2]=0):(h[f*8]=n[o[f].posIndex][0],h[f*8+1]=n[o[f].posIndex][1],h[f*8+2]=n[o[f].posIndex][2]),isNaN(o[f].normalIndex)?(h[f*8+3]=1,h[f*8+4]=0,h[f*8+5]=0):(h[f*8+3]=a[o[f].normalIndex][0],h[f*8+4]=a[o[f].normalIndex][1],h[f*8+5]=a[o[f].normalIndex][2]),isNaN(o[f].mtlIndex)?isNaN(o[f].texCoordIndex)?(h[f*8+6]=0,h[f*8+7]=0):(h[f*8+6]=s[o[f].texCoordIndex][0],h[f*8+7]=s[o[f].texCoordIndex][1]):(h[f*8+6]=o[f].mtlIndex/l.size+.5/l.size,h[f*8+7]=.5);return h})}},k=class{constructor(e,t){this.removed=!1,this.position2D=B.create(),this.fontSize=42,this.scaleWithWindow=!0,this.textString="",this.center=!1,this.ignoreEngineModifiers=!1,this.domElement=e,this.div=document.createElement("div"),this.div.style.position="absolute",this.div.style.width="fit-content",this.div.style.height="fit-content",this.div.style.userSelect="none",t!=null?(t.appendChild(this),this.hasParent=!0):(e.appendChild(this.div),this.hasParent=!1)}getElement(){return this.div}getHidden(){return this.div.hidden}setHidden(e){this.div.hidden=e}toggleHidden(){return this.div.hidden=!this.div.hidden,this.div.hidden}remove(){this.div.remove(),this.removed=!0}drawObject(){this.ignoreEngineModifiers||(this.div.style.left=this.position2D[0]*100+"%",this.div.style.top=this.position2D[1]*100+"%",this.scaleWithWindow?this.div.style.fontSize=this.fontSize*(this.domElement.clientHeight/1080)+"px":this.div.style.fontSize=this.fontSize+"px",this.center&&(this.div.style.transform="translate(-50%,-50%)"))}draw(){}},gs=class extends k{constructor(e,t){super(e,t),this.position=B.create(),this.textSize=42,this.inputNode=document.createElement("button"),this.inputNode.type="button",this.inputNode.className="button",this.div.appendChild(this.inputNode)}getElement(){return this.div}getInputElement(){return this.inputNode}onClick(e){this.onClickFunction=e,this.inputNode.addEventListener("click",this.onClickFunction)}remove(){this.onClickFunction!=null&&this.inputNode.removeEventListener("click",this.onClickFunction),super.remove()}draw(){this.position2D=this.position,this.fontSize=this.textSize,this.textString.length>0&&(this.inputNode.innerText=this.textString),this.drawObject()}},ps=class extends k{constructor(e,t){super(e,t),this.position=B.create(),this.textSize=42;let r=document.createElement("label");r.className="checkboxContainer",this.label=document.createElement("label"),this.label.style.fontSize="inherit",this.inputNode=document.createElement("input"),this.inputNode.type="checkbox";let i=document.createElement("span");i.className="checkmark",r.appendChild(this.label),r.appendChild(this.inputNode),r.appendChild(i),this.div.appendChild(r)}getElement(){return this.div}getInputElement(){return this.inputNode}getChecked(){return this.inputNode.checked}draw(){this.position2D=this.position,this.fontSize=this.textSize,this.label.textContent=this.textString,this.drawObject()}},us=class extends k{constructor(e,t){super(e,t),this.position=B.create(),this.size=42,this.children=new Array}appendChild(e){this.children.push(e),this.div.appendChild(e.getElement())}draw(){this.position2D=this.position,this.fontSize=this.size,this.drawObject()}},vs=class extends k{constructor(e,t){super(e,t),this.position=B.create(),this.size=42,this.progressNode=document.createElement("progress"),this.div.appendChild(this.progressNode)}getProgressElement(){return this.progressNode}draw(){this.position2D=this.position,this.fontSize=this.size,this.progressNode.textContent=this.textString,this.drawObject()}},xs=class extends k{constructor(e,t){super(e,t),this.position=B.create(),this.textSize=42,this.inputNode=document.createElement("input"),this.inputNode.type="range",this.inputNode.className="slider",this.label=document.createElement("label"),this.label.textContent=this.textString,this.label.className="sliderLabel",this.div.appendChild(this.label),this.div.appendChild(this.inputNode)}getElement(){return this.div}getInputElement(){return this.inputNode}getValue(){return Number(this.inputNode.value)}draw(){this.position2D=this.position,this.fontSize=this.textSize,this.label.textContent=this.textString,super.drawObject()}},Ms=class extends k{constructor(e,t){super(e,t),this.position=B.create(),this.textSize=42,this.inputNode=document.createElement("input"),this.inputNode.type="text",this.label=document.createElement("label"),this.label.textContent=this.textString,this.div.appendChild(this.label),this.div.appendChild(this.inputNode)}getElement(){return this.div}getInputElement(){return this.inputNode}onChange(e){this.onChangeFn=e,this.inputNode.addEventListener("change",this.onChangeFn)}remove(){this.onChangeFn!=null&&this.inputNode.removeEventListener("change",this.onChangeFn),super.remove()}draw(){this.position2D=this.position,this.fontSize=this.textSize,this.label.textContent=this.textString,this.drawObject()}},ys=class extends k{constructor(e,t){super(e,t),this.position=B.create(),this.size=42}draw(){this.position2D=this.position,this.fontSize=this.size,this.div.textContent=this.textString,this.drawObject()}},bs=class extends k{constructor(e){super(e),this.position=x.create(),this.size=42,this.scaleFontWithDistance=!0}setHidden(e){super.setHidden(e),this.hidden=e}draw3D(e){let t=j.fromValues(this.position[0],this.position[1],this.position[2],1),r=j.transformMat4(j.create(),t,e);if(r[0]=(r[0]/r[3]+1)/2,r[1]=1-(r[1]/r[3]+1)/2,r[2]>0&&!this.hidden){this.position2D[0]=r[0],this.position2D[1]=r[1];let i=this.size;this.scaleFontWithDistance&&(i=this.size/r[2]),this.fontSize=i,this.div.hidden=!1,this.div.textContent=this.textString,this.drawObject()}else this.div.hidden=!0}},xt=class{constructor(){this.guiObjects3D=new Array,this.guiObjects2D=new Array,this.domElement=document.createElement("div"),this.domElement.style.overflow="hidden"}setSize(e,t){this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"}clear(){for(let e of this.guiObjects2D)e.remove();for(let e of this.guiObjects3D)e.remove()}hide(){for(let e of this.guiObjects2D)e.hasParent||e.setHidden(!0);for(let e of this.guiObjects3D)e.setHidden(!0)}show(){for(let e of this.guiObjects2D)e.hasParent||e.setHidden(!1);for(let e of this.guiObjects3D)e.setHidden(!1)}getNew3DText(){let e=this.guiObjects3D.push(new bs(this.domElement));return this.guiObjects3D[e-1]}getNew2DText(e){let t=this.guiObjects2D.push(new ys(this.domElement,e));return this.guiObjects2D[t-1]}getNewCheckbox(e){let t=this.guiObjects2D.push(new ps(this.domElement,e));return this.guiObjects2D[t-1]}getNewButton(e){let t=this.guiObjects2D.push(new gs(this.domElement,e));return this.guiObjects2D[t-1]}getNewSlider(e){let t=this.guiObjects2D.push(new xs(this.domElement,e));return this.guiObjects2D[t-1]}getNewEditText(e){let t=this.guiObjects2D.push(new Ms(this.domElement,e));return this.guiObjects2D[t-1]}getNewProgress(e){let t=this.guiObjects2D.push(new vs(this.domElement,e));return this.guiObjects2D[t-1]}getNewDiv(e){let t=this.guiObjects2D.push(new us(this.domElement,e));return this.guiObjects2D[t-1]}draw(e){for(let t=0;t<this.guiObjects3D.length;t++)this.guiObjects3D[t].removed?(this.guiObjects3D.splice(t,1),t--):this.guiObjects3D[t].draw3D(e.getViewProjMatrix());for(let t=0;t<this.guiObjects2D.length;t++)this.guiObjects2D[t].removed?(this.guiObjects2D.splice(t,1),t--):this.guiObjects2D[t].draw()}},pe;(e=>{function t(i){if(i.length==0)return x.create();let n=x.create(),s=0;for(let a of i)a.shapeB.getTransformedNormals().length==1&&x.dot(a.axis,a.shapeB.getTransformedNormals()[0])<.99||a.depth>s&&(x.copy(n,a.axis),s=a.depth);return x.scale(n,n,s),n}e.getTranslationNeeded=t;function r(i,n,s){for(let a of i){let o=x.clone(a.axis);a.shapeB.getTransformedNormals().length==1?x.copy(o,a.shapeB.getTransformedNormals()[0]):a.shapeA.getTransformedNormals().length==1&&(x.copy(o,a.shapeA.getTransformedNormals()[0]),x.negate(o,o));let l=n.velocity,c=s.velocity,h=x.sub(x.create(),l,c);if(x.dot(h,o)<0){let m=x.cross(x.create(),x.cross(x.create(),h,o),o);x.squaredLength(m)>1e-4&&x.normalize(m,m);let d=x.create(),p=x.create(),u=Math.max(n.collisionCoefficient,s.collisionCoefficient),g=Math.min(n.frictionCoefficient,s.frictionCoefficient);if(n&&!n.isStatic&&!n.isImmovable&&s&&!s.isStatic&&!s.isImmovable){let y=x.dot(l,o),b=x.dot(c,o),E=x.dot(h,m),T=-E,M=(n.mass-u*s.mass)/(n.mass+s.mass)*y+(1+u)*s.mass/(n.mass+s.mass)*b,P=(s.mass-u*n.mass)/(s.mass+n.mass)*b+(1+u)*n.mass/(s.mass+n.mass)*y,D=-E*Math.min(g,g*Math.abs(M-y)),C=-T*Math.min(g,g*Math.abs(P-b));x.scaleAndAdd(d,d,o,M-y),x.scaleAndAdd(d,d,m,D),x.scaleAndAdd(p,p,o,P-b),x.scaleAndAdd(p,p,m,C)}else if(n.isStatic||n.isImmovable){let y=x.negate(x.create(),h),b=x.dot(y,o),T=x.dot(y,m)*Math.min(g,g*Math.abs(b));x.scaleAndAdd(p,p,o,-b*(1+u)),x.scaleAndAdd(p,p,m,-T)}else if(s.isStatic||s.isImmovable){let y=x.dot(h,o),E=x.dot(h,m)*Math.min(g,g*Math.abs(y));x.scaleAndAdd(d,d,o,-y*(1+u)),x.scaleAndAdd(d,d,m,-E)}x.add(l,l,d),d[1]>0&&(n.onGround=!0),x.add(c,c,p),p[1]>0&&(s.onGround=!0);let v=e.getTranslationNeeded([a]);!n.isImmovable&&!n.isStatic&&n.transform.translate(x.scale(x.create(),v,x.len(d)/(x.len(d)+x.len(p)))),!s.isImmovable&&!s.isStatic&&s.transform.translate(x.scale(x.create(),v,-x.len(p)/(x.len(d)+x.len(p))))}}}e.handleCollision=r})(pe||(pe={}));var q;(e=>{function t(a,o,l,c,h){let f=x.dot(a,o[0]),m=f,d=x.dot(a,l[0]),p=d,u=0;for(let y=1;y<o.length;y++)u=x.dot(a,o[y]),m=Math.min(u,m),f=Math.max(u,f);for(let y=1;y<l.length;y++)u=x.dot(a,l[y]),p=Math.min(u,p),d=Math.max(u,d);let g=d-m,v=f-p;return g>=-h&&v>=-h?g>v?(c.value=!0,v):(c.value=!1,g):-1}e.getOverlap=t;function r(a,o,l,c,h){let f=1/0,m=1/0,d=-1/0,p=-1/0,u=0;for(let y of o)u=x.dot(y,a),f=Math.min(f,u),d=Math.max(d,u);for(let y of l)u=x.dot(y,a),m=Math.min(m,u),p=Math.max(p,u);let g,v=x.dot(a,c);if(p<=f){if(v<=0||(g=(f-p)/v,g>h.first&&(h.first=g,x.copy(h.intersectionVec,a)),h.first>h.max)||(g=(d-m)/v,g<h.last&&(h.last=g),h.first>h.last))return!1}else if(d<=m){if(v>=0||(g=(d-m)/v,g>h.first&&(h.first=g,x.copy(h.intersectionVec,a)),h.first>h.max)||(g=(f-p)/v,g<h.last&&(h.last=g),h.first>h.last))return!1}else if(v>0){if(g=(d-m)/v,g<h.last&&(h.last=g),h.first>h.last)return!1}else if(v<0&&(g=(f-p)/v,g<h.last&&(h.last=g),h.first>h.last))return!1;return!0}e.getContinousOverlap=r;function i(a,o,l){let c=a.getTransformedVertices(),h=o.getTransformedVertices(),f=new Array,m=new Array,d=new Array,p=new Array,u=x.dot(l,c[0]);f.push(0);let g=u;m.push(0);let v=x.dot(l,h[0]);d.push(0);let y=v;p.push(0);let b=0;for(let P=1;P<c.length;P++)b=x.dot(l,c[P]),b<g?(g=b,m.length=0,m.push(P)):Math.abs(b-g)<1e-4&&m.push(P),b>u?(u=b,f.length=0,f.push(P)):Math.abs(b-u)<1e-4&&f.push(P);for(let P=1;P<h.length;P++)b=x.dot(l,h[P]),b<y?(y=b,p.length=0,p.push(P)):Math.abs(b-y)<1e-4&&p.push(P),b>v?(v=b,d.length=0,d.push(P)):Math.abs(b-v)<1e-4&&d.push(P);let E=Math.abs(v-g),T=Math.abs(u-y),M=x.create();return E>T?f.length==1?x.copy(M,c[f[0]]):p.length==1&&x.copy(M,h[p[0]]):m.length==1?x.copy(M,c[m[0]]):d.length==1&&x.copy(M,h[d[0]]),M}e.getIntersectionPoint=i;function n(a,o,l,c){c.depth=1/0;let h=a.getTransformedVertices(),f=o.getTransformedVertices(),m=function(u){let g={value:!1},v=e.getOverlap(u,h,f,g,a.margin+o.margin);return v<0?!1:(v<c.depth&&(c.depth=v,x.copy(l,u),g.value&&x.scale(l,l,-1)),!0)},d=o.getTransformedNormals();for(let u of d)if(!m(u))return!1;let p=a.getTransformedNormals();for(let u of p)if(!m(u))return!1;if(p.length==1&&d.length==1){let u=x.cross(x.create(),p[0],d[0]);if(u[0]==0&&u[1]==0&&u[2]==0){for(let g of a.getTransformedEdgeNormals())if(!m(g))return!1;for(let g of o.getTransformedEdgeNormals())if(!m(g))return!1;return!0}}for(let u of a.getTransformedEdges())for(let g of o.getTransformedEdges()){let v=x.dot(u,g);if(v<.99&&v>-.99){let y=x.clone(u);if(x.normalize(y,x.cross(y,y,g)),!m(y))return!1}}return!0}e.getIntersection3D=n;function s(a,o,l,c,h){let f=x.subtract(x.create(),c,l),m={first:0,last:1/0,max:h,intersectionVec:x.create()},d=a.getTransformedVertices(),p=o.getTransformedVertices(),u=a.getTransformedNormals();for(let v of u)if(!r(v,d,p,f,m))return[1/0,null];let g=o.getTransformedNormals();for(let v of g)if(!r(v,d,p,f,m))return[1/0,null];if(u.length==1&&g.length==1){let v=x.cross(x.create(),u[0],g[0]);if(v[0]==0&&v[1]==0&&v[2]==0){for(let y of a.getTransformedEdgeNormals())if(!r(y,d,p,f,m))return[1/0,null];for(let y of o.getTransformedEdgeNormals())if(!r(y,d,p,f,m))return[1/0,null];return m.last==0?[1/0,null]:[m.first,m.intersectionVec]}}for(let v of a.getTransformedEdges())for(let y of o.getTransformedEdges()){let b=x.dot(v,y);if(b<.99&&b>-.99){let E=x.clone(v);if(x.normalize(E,x.cross(E,E,y)),!r(E,d,p,f,m))return[1/0,null]}}return m.last==0?[1/0,null]:[m.first,m.intersectionVec]}e.getContinousIntersection3D=s})(q||(q={}));var ue;(e=>{class t{constructor(o,l,c,h,f){this.axis=x.clone(o),this.depth=l,this.point=x.clone(c),this.shapeA=h,this.shapeB=f}}e.IntersectionInformation=t;function r(a,o){let l=x.create(),c={depth:1/0};for(let h of a)for(let f of o)if(q.getIntersection3D(h,f,l,c))return!0;return!1}e.identifyIntersection=r;function i(a,o,l){let c=!1,h=x.create(),f={depth:1/0};for(let m of a)for(let d of o)q.getIntersection3D(m,d,h,f)&&(c=!0,l.push(new t(h,f.depth,q.getIntersectionPoint(m,d,h),m,d)));return c}e.identifyIntersectionInformation=i;function n(a,o,l=1/0,c=!1){let h=1/0;for(let f of o){let[m,d]=q.getContinousIntersection3D(a,f,a.getDir(),x.create(),l);if(m<h&&(h=m,l=h,c))return h}return h}e.doRayCast=n;function s(a,o,l,c,h=1/0,f=!0,m=!1){let d=1/0,p=null;for(let u of a)for(let g of l){let[v,y]=q.getContinousIntersection3D(u,g,o,c,h);if((f&&v>=0||v>0)&&v<d&&(d=v,p=y,h=d,m))return[d,p]}return[d,p]}e.doContinousIntersection=s})(ue||(ue={}));var ws=class{constructor(){this.margin=0}setUpdateNeeded(){}setTransformMatrix(e){}getOriginalVertices(){return null}getTransformedVertices(){return null}getTransformedNormals(){return null}getTransformedEdges(){return null}getTransformedEdgeNormals(){return null}};var Es=class extends ws{constructor(){super(),this.start=x.create(),this.dir=x.fromValues(0,0,1),this.inverseMatrix=W.create()}setStart(e){x.copy(this.start,e)}setDir(e){x.normalize(this.dir,e)}getDir(){return this.getTransformedNormals()[0]}setStartAndDir(e,t){x.copy(this.start,e),x.normalize(this.dir,t)}setInverseMatrix(e){this.inverseMatrix=e}getTransformedVertices(){return[x.transformMat4(x.create(),this.start,this.inverseMatrix)]}getTransformedNormals(){let e=this.getTransformedVertices()[0],t=x.transformMat4(x.create(),x.add(x.create(),this.start,this.dir),this.inverseMatrix);return[x.subtract(x.create(),t,e)]}getTransformedEdges(){return[]}getTransformedEdgeNormals(){return[]}},ve;(e=>{function t(r,i){let n=j.fromValues(i[0],i[1],-1,1),s=j.transformMat4(j.create(),n,W.invert(W.create(),r.getProjectionMatrix()));s[2]=-1,s[3]=0;let a=j.transformMat4(j.create(),s,W.invert(W.create(),r.getViewMatrix())),o=x.normalize(x.create(),x.fromValues(a[0],a[1],a[2])),l=new Es;return l.setDir(o),l.setStart(x.clone(r.getPosition())),l}e.GetRay=t})(ve||(ve={}));var Cs=Date.now(),Ps=new fs,Fs=new ms(Ps);xe.setMatrixArrayType(Array);function X(e){let t=e+"=",i=decodeURIComponent(document.cookie).split(";");for(let n=0;n<i.length;n++){let s=i[n];for(;s.charAt(0)==" ";)s=s.substring(1);if(s.indexOf(t)==0)return s.substring(t.length,s.length)}return""}function Y(e,t,r=365){let i=new Date;i.setTime(i.getTime()+r*24*60*60*1e3);let n="expires="+i.toUTCString();document.cookie=e+"="+t+";"+n}String.prototype.hashCode=function(){var e=0,t,r;if(this.length===0)return e;for(t=0;t<this.length;t++)r=this.charCodeAt(t),e=(e<<5)-e+r,e|=0;return e};var V=class{constructor(t,r,i,n,s){this.name=t,this.description=r,this.score=i,this.time=n,this.solved=!1,this.passed=!1,this.key=s,this.button=null}createGuiElement(t=null){this.button=L.getNewButton(t),this.button.ignoreEngineModifiers=!0,this.button.getInputElement().innerHTML=`
        <div class="flex-container" style="display: flex; justify-content: space-around">
            <span style="color:#F7E4C7; width: 25%; text-align: left;">`+this.name+`</span>
            <span style="color:#F7E4C7; width: 25%; text-align: right;">`+this.score+`</span>
            <span style="color:#F7E4C7; width: 25%; text-align: right;">`+this.time+`</span>
        </div>
        `,this.button.getElement().style.position="relative",this.button.getElement().style.width="",this.button.getInputElement().style.width="100%",this.button.getElement().style.padding="2px 4px",X(this.key)=="solved"&&this.markAsSolved(),X(this.key)=="passed"&&this.markAsPassed();let r=this;this.button.onClick(function(){r.solved||r.passed||r.createBriefingPage()})}createBriefingPage(){O.getElement().style.display="none";let t=L.getNewDiv();t.ignoreEngineModifiers=!0,t.getElement().style.width="100%",t.getElement().style.height="100%",t.getElement().style.overflowY="auto",t.getElement().style.fontSize="50px";let r=L.getNew2DText(t);r.ignoreEngineModifiers=!0,r.getElement().style.padding="40px 20px",r.getElement().style.position="relative",r.textString="You are about to start the "+this.name+" mission. Starting a mission means you have to finish it, or forfeit the mission at which point you will not be allowed to try the mission again.";let i=L.getNewDiv(t);i.ignoreEngineModifiers=!0,i.getElement().style.padding="30px 0px",i.getElement().style.position="relative",i.getElement().innerHTML='<p>This mission will award <span style = "font-size: inherit; color: #245C5C;">'+this.score+'</span> points and <span style = "font-size: inherit; color: #245C5C;">'+this.time+"</span> seconds of navigation time</p>";let n=L.getNewButton(t);n.ignoreEngineModifiers=!0,n.getInputElement().style.background="#138832",n.getElement().style.padding="40px 20px",n.getElement().style.position="relative",n.getElement().style.display="block",n.getElement().style.margin="auto",n.getInputElement().innerHTML="Agree";let s=this;n.onClick(function(){t.remove(),s.createMissionPage()});let a=L.getNewButton(t);a.ignoreEngineModifiers=!0,a.getInputElement().style.background="#781a1a",a.getElement().style.padding="40px 20px",a.getElement().style.position="relative",a.getElement().style.display="block",a.getElement().style.margin="auto",a.getInputElement().innerHTML="Decline",a.onClick(function(){t.remove(),O.getElement().style.display=""})}createMissionPage(){O.getElement().style.display="none",Y("CurrentMission",this.key.toString());let t=L.getNewDiv();t.ignoreEngineModifiers=!0,t.getElement().style.width="100%",t.getElement().style.height="100%",t.getElement().style.overflowY="auto",t.getElement().style.fontSize="50px";let r=L.getNew2DText(t);r.ignoreEngineModifiers=!0,r.getElement().style.fontSize="80px",r.getElement().style.textAlign="center",r.getElement().style.margin="auto",r.getElement().style.padding="40px 20px",r.getElement().style.position="relative",r.textString=this.name;let i=L.getNew2DText(t);i.ignoreEngineModifiers=!0,i.getElement().style.padding="40px 20px",i.getElement().style.position="relative",i.textString=this.description;let n=L.getNewDiv(t);n.ignoreEngineModifiers=!0,n.getElement().style.padding="30px 0px",n.getElement().style.position="relative",n.getElement().innerHTML=`
        <p>Send the email to <a style="color: #245C5C;" href= "mailto: scavengerhunt@msab.com"> scavengerhunt@msab.com</a>. Add the mission name and your team number as the Subject.</p>
        <p>When we have received a photo of a correctly executed mission, you will get the password in return. Enter the password to unlock your navigation time. </p>
        <p>This mission will award <span style = "font-size: inherit; color: #245C5C;">`+this.score+'</span> points and <span style = "font-size: inherit; color: #245C5C;">'+this.time+"</span> seconds of navigation time</p>";let s=L.getNewEditText(t);s.ignoreEngineModifiers=!0,s.getElement().style.padding="40px 20px",s.getElement().style.position="relative",s.getInputElement().style.fontSize="inherit",s.textString="Passcode ";let a=L.getNewButton(t);a.ignoreEngineModifiers=!0,a.getInputElement().style.background="#138832",a.getElement().style.padding="40px 20px",a.getElement().style.position="relative",a.getElement().style.display="block",a.getElement().style.margin="auto",a.getInputElement().innerHTML="Submit";let o=this;a.onClick(function(){o.solve(s.getInputElement().value)?(t.remove(),G.time=o.time):(s.getInputElement().value="",s.getInputElement().style.background="red",setTimeout(function(){s.getInputElement().style.background=""},100))});let l=L.getNewButton(t);l.ignoreEngineModifiers=!0,l.getInputElement().style.background="#781a1a",l.getElement().style.padding="40px 20px",l.getElement().style.position="relative",l.getElement().style.display="block",l.getElement().style.margin="auto",l.getInputElement().innerHTML="Forfeit",l.onClick(function(){o.pass(),t.remove(),O.getElement().style.display=""})}markAsSolved(){this.solved=!0,this.button.getInputElement().style.background="#138832"}solve(t){return t.hashCode()==this.key?(this.markAsSolved(),Y(this.key,"solved"),!0):!1}markAsPassed(){this.passed=!0,this.button.getInputElement().style.background="#781a1a"}pass(){this.markAsPassed(),Y(this.key,"passed")}},de=class{constructor(t){this.textAndAlignment=t}createGuiElement(t=null){let r=L.getNewDiv(t);r.ignoreEngineModifiers=!0,r.getElement().style.class="flex-container",r.getElement().style.display="flex",r.getElement().style.justifyContent="space-around",r.getElement().style.position="relative",r.getElement().style.padding="0px 25px",r.getElement().style.width="";for(let i of this.textAndAlignment){let n=L.getNew2DText(r);n.ignoreEngineModifiers=!0,n.textString=i[0],n.getElement().style.position="relative",n.getElement().style.color="#245C5C",n.getElement().style.textAlign=i[1],n.getElement().style.padding="5px",n.getElement().style.width="25%",n.getElement().style.fontSize="26px"}}},$=class{constructor(){this.guiElements=[new de([["Mission name","left"],["Points","right"],["Navigation seconds","right"]]),new V("The store","Email us a photo of a team member in front of a display window where something green is on display. ",1,255,-1357631257),new V("The tree","Email us a photo of one or more team members hugging a tree. ",2,240,-1536133251),new V("The jump","Email us a photo of team members jumping in the air, the higher the better. The photo must include at least two team members. ",3,225,-1912358105),new V("The word","Email us a photo of the team spelling out a word, using their bodies as the letters. ",4,210,2558810),new V("The band","Email us a photo of the team in the style of an imaginary black metal album cover. The photo must include at least three team members. ",5,195,67914621),new V("The position","Email us a photo of one or more team members doing a yoga pose in a beautiful setting. ",6,180,-2008848680),new V("The flower","Email us a photo of at least one team member with a bouquet of flowers. ",7,165,79936545),new V("The animal","Email us a photo of an animal that is smaller than a shopping cart. The photo must include at least two team members. ",8,150,-1790579581),new V("The sign","Email us a photo of a team member and the text MSAB. The letters in MSAB must be created by objects that you find. ",9,135,2301393),new V("The art","Email us a photo of at least one team member interacting with a statue or sculpture.",10,120,2394075),new V("The child","Email us a photo of at least one team member playing on a playground.",11,105,-1354140033),new V("The class","Email us a photo of the team in the style of a class photo. The photo must include a park bench and all team members. ",12,90,1549467325),new V("The music","Email us a photo that illustrates a song title. The photo must include at least one team member. ",13,75,1360946844),new V("The vehicle","Email us a photo of a team member and a license plate where the letters form a word.",14,60,71762568),new V("The movie","Email us a photo where the team re-enacts a recognizable movie scene. The photo must include at least two team members. ",15,45,68143570),new V("The uniform","Email us a photo of one team member and a stranger in uniform. You must ask the stranger for permission, and it must be obvious from the photo that they are participating in the picture. ",16,30,-813315778),new V("The stranger","Email us a photo of a team member and a stranger in a white skirt or white pants. You must ask the stranger for permission, and it must be obvious from the photo that they are participating in the picture. ",17,15,123463235)]}createGui(t=null){let r=L.getNewDiv(t);r.ignoreEngineModifiers=!0,r.getElement().style.background="#E4B46B 0% 0% no-repeat padding-box",r.getElement().style.height="fit-content",r.getElement().style.width="100%",r.getElement().style.position="relative",r.getElement().style.fontSize="26px",r.getElement().innerHTML=`
        <div class="flex-container" style="display: flex; justify-content: space-around;">
            <img src="Assets/male_viking.png" style="float: left; width: 25%; object-fit: contain;">
            <p style="color: #1F160D; font-size: 40px; text-align: center; width: 50%">Scavenger Hunt</p>
            <img src="Assets/female_viking.png" style="float: right; width: 25%; object-fit: contain;">
        </div>
        
        <p class="pl">Hildur exclaims:<br> - Hello friend! Come Feast with us! But first you will help us.</p>
        <p class="pr">Selgir explains:<br> - Accomplish a mission and get navigation time to find the entrance...</p>
        <p class="pl">Hildur clarifies:<br> - What you really want is points which you get for each accomplished mission.</p>
        <p class="pr">Selgir hurries:<br> - NOW GO! The feast is awaiting!</p> 
        `;let i=L.getNewDiv(t);i.ignoreEngineModifiers=!0,i.getElement().style.width="100%",i.getElement().style.position="relative";for(let s of this.guiElements)s.createGuiElement(i);let n=X("CurrentMission");for(let s of this.guiElements)s.key!=null&&s.key.toString()==n&&!s.passed&&!s.solved&&s.createMissionPage()}};function Ss(e,t,r,i){var n=6371,s=re(r-e)-.0001775663,a=re(i-t)-73234e-10,o=Math.sin(s/2)*Math.sin(s/2)+Math.cos(re(e))*Math.cos(re(r))*Math.sin(a/2)*Math.sin(a/2),l=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)),c=n*l;return c}function re(e){return e*(Math.PI/180)}var ie=class{constructor(t){this.timer=t,this.distance=NaN,this.div=L.getNewDiv(),this.div.ignoreEngineModifiers=!0,this.div.getElement().style.width="100%",this.div.getElement().style.height="100%",this.div.getElement().style.overflowY="auto",this.div.getElement().style.fontSize="50px",this.timerText=L.getNewDiv(this.div),this.timerText.ignoreEngineModifiers=!0,this.timerText.getElement().style.padding="30px 0px",this.timerText.getElement().style.position="relative",this.timerText.getElement().style.textAlign="center",this.timerText.getElement().style.display="block",this.timerText.getElement().style.margin="auto",this.distanceText=L.getNewDiv(this.div),this.distanceText.ignoreEngineModifiers=!0,this.distanceText.getElement().style.padding="30px 0px",this.distanceText.getElement().style.position="relative",this.distanceText.getElement().style.textAlign="center",this.distanceText.getElement().style.display="block",this.distanceText.getElement().style.margin="auto",this.confirmCancellation=L.getNewCheckbox(this.div),this.confirmCancellation.ignoreEngineModifiers=!0,this.confirmCancellation.getElement().style.padding="40px 20px",this.confirmCancellation.getElement().style.position="relative",this.confirmCancellation.getElement().style.fontSize="inherit",this.confirmCancellation.getInputElement().checked=!1,this.confirmCancellation.textString="I understand that by cancelling the navigation I will lose my navigation time",this.cancelButton=L.getNewButton(this.div),this.cancelButton.ignoreEngineModifiers=!0,this.cancelButton.getElement().style.padding="40px 20px",this.cancelButton.getElement().style.position="relative",this.cancelButton.getElement().style.display="block",this.cancelButton.getElement().style.margin="auto",this.cancelButton.textString="Cancel navigation",this.cancelButton.getInputElement().disabled=!0;let r=this;this.cancelButton.onClick(function(){r.timer=0}),this.positionTimer=9999}update(t){if(this.timer-=t,this.positionTimer>4){if(navigator.geolocation){let r=this;navigator.geolocation.getCurrentPosition(function(i){r.distance=Math.ceil(Ss(59.3123933,18.0750245,i.coords.latitude,i.coords.longitude)*1e3)},null,{maximumAge:4e3,timeout:4e3,enableHighAccuracy:!0})}this.positionTimer=0}this.positionTimer+=t,this.timerText.getElement().innerHTML='<p><span style = "font-size: inherit; color: #245C5C;">'+Math.ceil(this.timer).toString()+"</span> seconds left of navigation</p>",this.distanceText.getElement().innerHTML=`<p>Distance to goal (m)</p>
        <p><span style = "font-size: inherit; color: #245C5C;">`+this.distance.toString()+"</span></p>",this.timer<=0&&(this.div.remove(),O.getElement().style.display="",G.time=0,navigator.geolocation&&this.watchId!=null&&navigator.geolocation.clearWatch(this.watchId)),this.cancelButton.getInputElement().disabled=!this.confirmCancellation.getChecked(),Y("t",this.timer)}};var L=new xt;document.body.appendChild(L.domElement);L.domElement.className="guiContainer";var O=L.getNewDiv();O.ignoreEngineModifiers=!0;O.getElement().style.width="100%";O.getElement().style.height="100%";O.getElement().style.display="flex";O.getElement().style.flexDirection="column";O.getElement().style.overflowY="auto";var As=new $;As.createGui(O);var Q=null,G={time:parseFloat(X("t"))},Ds=function(e){G.time>0&&Q==null?(O.getElement().style.display="none",Q=new ie(G.time)):Q!=null&&G.time<=0&&(Q=null),Q!=null&&Q.update(e)},yt=function(){let e=window.innerWidth,t=window.innerHeight;L.setSize(e,t)};yt();window.addEventListener("resize",()=>{yt()});var Mt=Date.now();function bt(){requestAnimationFrame(bt);let e=Date.now(),t=(e-Mt)*.001;Mt=e,Ds(t),L.draw(null)}bt();export{L as guiRenderer,O as mainMenuDiv,G as navigationTimer};
